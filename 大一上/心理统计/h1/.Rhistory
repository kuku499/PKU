library("readxl")
data <- read_excel("hw1_data.xlsx",sheet=1)
attach(data)
sprintf("%.2f",mean(condition_a))
sprintf("%.2f",median(condition_a))
sprintf("%.2f",sd(condition_a))
sprintf("%.2f",var(condition_a))
sprintf("%.2f",mean(condition_b))
sprintf("%.2f",median(condition_b))
sprintf("%.2f",sd(condition_b))
sprintf("%.2f",var(condition_b))
# 参数
mu0 <- 143
mu1 <- 148
sigma <- 12
n <- 30
alpha <- 0.05
# 标准误
se <- sigma / sqrt(n)
# 双尾检验的临界值（两侧各α/2）
z_crit <- qnorm(1 - alpha/2)   # = 1.96
x_crit <- mu0 + z_crit * se
x_crit_lower <- mu0 - z_crit * se
# 在H1下，样本均值分布中心偏移
mu_z <- (mu1 - mu0) / se   # H1下Z的均值
# 双尾power = 两侧尾面积
power <- pnorm(-z_crit, mean = mu_z, sd = 1) + (1 - pnorm(z_crit, mean = mu_z, sd = 1))
cat("统计检验力（power） =", round(power, 3), "\n")
# 作图范围
x <- seq(130, 165, length = 1000)
H0 <- dnorm(x, mean = mu0, sd = se)
H1 <- dnorm(x, mean = mu1, sd = se)
df <- data.frame(x, H0, H1)
# 绘图
library(ggplot2)
# 参数
mu0 <- 143
mu1 <- 148
sigma <- 12
n <- 30
alpha <- 0.05
# 标准误
se <- sigma / sqrt(n)
# 双尾检验的临界值（两侧各α/2）
z_crit <- qnorm(1 - alpha/2)   # = 1.96
x_crit <- mu0 + z_crit * se
x_crit_lower <- mu0 - z_crit * se
# 在H1下，样本均值分布中心偏移
mu_z <- (mu1 - mu0) / se   # H1下Z的均值
# 双尾power = 两侧尾面积
power <- pnorm(-z_crit, mean = mu_z, sd = 1) + (1 - pnorm(z_crit, mean = mu_z, sd = 1))
cat("统计检验力（power） =", round(power, 3), "\n")
# 作图范围
x <- seq(130, 165, length = 1000)
H0 <- dnorm(x, mean = mu0, sd = se)
H1 <- dnorm(x, mean = mu1, sd = se)
df <- data.frame(x, H0, H1)
# 绘图
library(ggplot2)
ggplot(df, aes(x)) +
geom_line(aes(y = H0), color = "black", size = 1) +
geom_line(aes(y = H1), color = "blue", size = 1) +
# 阴影：拒绝域（左尾）
geom_area(data = subset(df, x >= x_crit),
aes(y = H1), fill = "blue", alpha = 0.3) +
# 阴影：拒绝域（左尾）
geom_area(data = subset(df, x <= mu0 - z_crit * se),
aes(y = H1), fill = "blue", alpha = 0.3) +
# 辅助线
geom_vline(xintercept = x_crit, linetype = "dashed", color = "red") +
geom_vline(xintercept = mu0 - z_crit * se, linetype = "dashed", color = "red") +
annotate("text", x = x_crit, y = 0.05, label = "临界值1", color = "red", hjust = -0.2) +
annotate("text", x = mu0 - z_crit * se, y = 0.05, label = "临界值2", color = "red", hjust = -0.2) +
annotate("text", x = mu0, y = 0.38, label = "H0: μ=143", color = "black") +
annotate("text", x = mu1, y = 0.38, label = "H1: μ=148", color = "blue") +
labs(title = paste0("双尾检验（H0: μ₁ = μ₀）\nPower ≈ ", round(power, 3)),
x = "样本均值", y = "概率密度") +
theme_minimal(base_size = 14)
# 定义参数
alpha <- 0.05
mu0 <- 148
mu1 <- 143
sigma <- 12
effect_size <- abs(mu1 - mu0)
# 计算Z分布下的样本量 (使用课件公式)
# n = ( (Z_{1-β} + Z_{1-α}) * σ / (μ0 - μ1) )^2
# 计算不同检验力所需的样本量 (Z分布)
n_80 <- ( (qnorm(0.80) + qnorm(1-alpha)) * sigma / effect_size )^2
n_90 <- ( (qnorm(0.90) + qnorm(1-alpha)) * sigma / effect_size )^2
# 输出结果（向上取整）
print(paste("Z分布 - 检验力80%所需样本量 =", ceiling(n_80))) # 输出 36
print(paste("Z分布 - 检验力90%所需样本量 =", ceiling(n_90))) # 输出 50
