# 关于考试的下载包
# 改字体：Tools-Global Options-Appearance

## 一、单项选择题（每道题6分，共5题，共30分）：
1、在一项单词记忆实验中，研究者给被试呈现两类单词：高频词占全部单词的70%，被正确回忆的概率是0.8；低频词占全部单词的30%，被正确回忆的概率是0.6。则被试在所有单词中的平均回忆正确率是（ D ）
（A）0.68
（B）0.70
（C）0.72
（D）0.74
# 解析：利用全概率公式，各个单词呈现的概率乘上对应的正确率之和即为总的正确率，即0.7 × 0.8 + 0.3 × 0.6 = 0.56 + 0.18 = 0.74，故D正确。


2、在一项单词记忆实验中，被试能真正记住40%的目标单词。若被试记住了，测试时能正确回忆出的概率是0.9；若没记住，依然有0.2的概率“猜对”。现在某位被试在测试中正确回忆出了单词，他真的记住了的概率是（ C ）
（A）0.40
（B）0.64
（C）0.75
（D）以上都不对
# 解析：记住的概率 = 0.4，没记住的概率 = 0.6，记住后能正确回忆的概率 = 0.9，没记住但猜对的概率 = 0.2。根据贝叶斯公式 
$$P(记住|正确回忆) = \frac{P(正确回忆|记住)\cdot P(记住)}{P(正确回忆|记住)\cdot P(记住) + P(猜对|没记住)\cdot P(没记住)} = \frac{0.9\times0.4}{0.9\times0.4 + 0.2\times0.6} = 0.75$$ 
# 贝叶斯公式非常重要


3、某智力问卷有10道二选一题目，每道题随机猜对的概率是0.5。若被试完全瞎猜，恰好答对6道的概率是（ A ）
（A）0.205
（B）0.246
（C）0.377
（D）以上都不对
# 解析：将n = 10，x=6，p = 0.5带入二项式公 P(x=6)=n!/x!(n-x)! [p^x · (1-p)^(n-x)]，得210/1024 故A正确。
```{r}
# 可以直接用二项分布的pmf的纵坐标来算
dbinom(6, 10, 0.5)
```

```{r}
# 一系列函数 d r p q
# dbinom(x, size, prob)
# 概率密度函数（Probability Density Function，PDF）和概率质量函数（Probability Mass Function，PMF）的纵坐标
# 概率质量函数（PMF）上某一点的取值即为随机变量取到这个点的横坐标的值的概率 true

# rbinom(n, size, prob)
# 生成n个符合参数size和prob的随机二项分布数据
set.seed(123) # 保证结果可重复
a = rbinom(300,100,0.77)
print(a)
hist(a)
```

```{r}
# pbinom(q, size, prob, lower.tail = TRUE)
# p(x<=q)，累积分布函数（Cumulative Distribution Function，CDF）
# 累积分布函数的取值范围是[0,1] true
# 累积分布函数中如果x1<x2，那么f(x1)<f(x2) wrong：递增但不严格递增

pbinom(80,100,0.77)

# 对于参数为100,0.77的二项分布，标准正态分布取到(-无穷,80]的概率是0.54（其实就是[0,80]）
# 如何验证是取到闭区间而不是开区间（如果忘了）
pbinom(100,100,0.77)
pbinom(99,100,0.77)

pbinom(10,10,0.77)
pbinom(9,10,0.77)
pbinom(10,10,0.77) - pbinom(9,10,0.77)
dbinom(10,10,0.77)
```

```{r}
# qbinom(p, size, prob, lower.tail = TRUE)
# pbinom的反函数
# 要想保证左边闭区间的概率为p，对应的横坐标是多少
# 累积分布函数（Cumulative Distribution Function，CDF）纵坐标对应的横坐标
qbinom(0.92,10,0.77)
qbinom(0.93,10,0.77)
# 对于离散型变量，需要格外注意输出结果
```


4、某注意实验中，被试平均反应时为500ms，标准差为50ms。小明的反应时为650ms，他的z分数是（ C ）
（A）2.0
（B）2.5
（C）3.0
（D）3.5
# 解析：z = (x-u)/σ =  (650-500)/50 = 3，故D正确。


5、小明参加了期末考试，他的语文成绩和数学成绩在班上的z分数都相同，则他的语文排名和数学排名（假设没有人和小明同分）在班上（ D ）
（A）语文排名靠前
（B）数学排名靠前
（C）排名相同
（D）无法确定
# 解析：z分数相同只能确定其离均值的距离为多少个标准差，但是其排名（百分位数）需要根据具体分布情况来定。z分数只反映相对标准化位置，并不能确定百分位数。如在r中计算得到，正态分布的z=1处的百分位数和二项分布的z=1处的百分位数就不相同：

```{r}
1 - pnorm(2,mean = 1,sd = 1)
# 正态分布，均值为1，标准差为1，2对应的z分数为1

1 - pbinom(93,100,0.9)
# 二项分布，n=100，p=0.9
# 均值为90，标准差为3,93对应的z分数为1
```

一个直观的例子
```{r}
# 生成偏态的分布数据
set.seed(123)
data <- rbeta(100, 2, 4)  # 调整Beta分布参数，右偏更明显
# 绘制密度图

plot(density(data), main="", xlab="data", ylab="density", lwd=2)

# 在图上添加一条竖线
abline(v=mean(data), col="purple", lwd=2)
abline(v=mean(data) + 1.5 * sd(data), col="red", lwd=2)

data2 = 10 - data
plot(density(data2), main="", xlab="data", ylab="density", lwd=2)
abline(v=mean(data2), col="purple", lwd=2)
abline(v=mean(data2) + 1.5 * sd(data2), col="red", lwd=2)
```

```{r}
# 生成偏态的分布数据
set.seed(123)
data <- rbeta(100, 2, 4)  # 调整Beta分布参数，右偏更明显
# 绘制密度图

plot(density(data), main="", xlab="data", ylab="density", lwd=2)

# 在图上添加一条竖线
abline(v=mean(data), col="purple", lwd=2)
abline(v=mean(data) - sd(data), col="green", lwd=2)
abline(v=mean(data) + sd(data), col="red", lwd=2)

sum(data < mean(data) - 1.5 * sd(data))
sum(data > mean(data) + 1.5 * sd(data))
```


## 二、不定项选择题（每道题8分，共3题，少选得4分，错选得0分，共24分）：
6、关于标准化，下列说法正确的是（ ABD ）
（A）标准化不会改变分布的大体形状。
（B）标准化后的数据仍保持原来数据的相对大小关系。
（C）如果原始数据服从二项分布，标准化后也一定服从二项分布。
（D）标准化可以消除不同量纲对比较的影响。
# 解析：A和B显然正确；标准化本质上是对原始数据进行线性变换，Y = aX+b，a = 1/σ，b = -μ/σ，二项分布经过线性变换后不能得到二项分布，这里不作具体数学证明，但可以用直观的方法反证。首先二项分布必须是离散型的整数分布，进行标准化之后可能不是整数，因此不符合二项分布；此外标准化之后会出现负数，这也不符合二项分布（但需要注意的是正态分布经过线性变换之后仍然是正态分布）；标准化可以消除不同量纲对比较的影响，这也是标准化的主要应用场景之一，D正确。

```{r}
set.seed(13)
x1 = rbinom(100,100,0.9)
x2 = (x1-90)/3
mean(x2)
sd(x2)
hist(x1)
hist(x2)
# 二项分布是很严格的，不像正态分布可以在横坐标上任意左右移动
```


7、某研究团队通过投掷一枚均匀的硬币（正面朝上的概率为50%）将50名被试分配到实验组或对照组。每名被试投一次硬币，若正面朝上则分配到实验组，反面朝上则分配到对照组。关于这50名被试的分配结果，下列说法正确的有 （ ABCD ）。
（A）实验组和对照组分配人数的期望均为25人。
（B）实验组人数的概率分布是对称的。
（C）实验组人数大于25的概率和少于25的概率相等。
（D）实验组人数多于对照组人数概率和实验组人数少于对照组人数概率相等。
# 解析：实验组和对照组的人数均符合二项分布，n=50，p=0.5。E(X)=n×p=50×0.5=25，A正确。二项分布在 p=0.5 时关于n/2对称，B正确；且对称性不仅体现在概率值，还体现在总体分布：P(X>25) = P(X<25)，C正确；实验组和对照组符合同一分布，二者在概率计算时可以互换，即P（A>B）=P（B>A），D正确。

# 这里的C是不能说大于等于25的概率等于小于25的概率的，因为是离散型变量
# 遇到数据量大的题避免没必要的具体运算（不过在本门课上较为少见）


8、关于概率质量函数（PMF）和累积分布函数（CDF），下列说法中正确的是（ ABD ）。
（A）概率质量函数（PMF）在a处的取值代表Pr(x = a)的概率。
（B）概率质量函数（PMF）所有纵坐标取值的和等于 1。
（C）对于累积分布函数（CDF），只要a > b，就一定有F(a) > F(b)。
（D）概率质量函数（PMF）和累积分布函数（CDF）的纵坐标取值都是介于区间[0, 1]之间的。
# 解析：A正确；概率之和必定为1，B正确；累积分布函数只能保证只要a>b，就一定有F(a)>=F(b)，二者概率可能相等，C错误；概率质量函数的纵坐标取值表示概率，因此在0-1之间，CDF的纵坐标取值表示累积概率，也在0-1之间，D正确。
B 离散型变量的CDF是呈现出阶梯函数的形式
PDF的纵坐标取值也在0-1之间吗？


## 三、简答题（共3题，共计46分）：（需要计算的地方可手算，也可以使用统计软件进行计算；手算请写出计算过程；使用统计软件计算请附代码运行截图并提交rmd文件）
9、（共9分）在以 X为随机变量的某总体中，x1=72所对应的 Z分数为1.25 ，x2=56所对应的 Z分数是-0.75（结果*保留三位小数*或写成分数）。
（1）请计算总体平均值 μ（3分）和总体标准差 σ（3分）。
解析：(72-u)/σ  = 1.250 ， (56-u)/σ = -0.750。计算得u=62，σ=8。
（2）请找出 X = 65对应的 Z分数（3分）。
解析：Z = (x-u)/σ = (65-62)/8 = 3/8 =0.375。
```{r}
#（1）
# 解两个方程来计算μ和σ
x1 <- 72
x2 <- 56
z1 <- 1.25
z2 <- -0.75

# 计算σ
sigma <- (x1 - x2) / (z1 - z2)

# 计算μ
mu <- x1 - z1 * sigma

# 输出μ和σ
print(paste("mu是:", mu))
print(paste("sigma是:", sigma))

#（2）
# 定义已知值
mu <- 62
sigma <- 8
x <- 65

# 计算 Z 分数
z_score <- (x - mu) / sigma

# 输出结果
print(paste("z_score是:", z_score))
```


10、（共30分）在一次心理物理学实验中，屏幕上随机“出现刺激”或“不出现刺激”，同学们需要检测并报告屏幕上是否“出现刺激”，如果认为屏幕出现刺激则需要进行报告。已知屏幕中刺激出现的概率为70%，且每次刺激是否出现可视为独立事件。对于小明来说，如果刺激确实出现了，小明有90%的概率进行报告（称为“击中”），有10%的概率不报告（称为“漏报”）。如果刺激没有出现，小明有30%的概率进行报告（称为“虚报”），有70%的概率不报告（称为“正确否定”）
#（结果保留三位小数或写成分数）

（1）（5分）使用Multiplication Law计算小明“击中”（即刺激确实出现并且小明进行报告）的概率。
解析：$$P(击中) = P(出现)\cdot(报告|出现) = 0.7\times0.9 = 0.630$$

（2）（5分）使用Addition Law计算小明进行报告（包括击中和虚报）的概率。
解析$$P(报告) = P(出现)\cdot(报告|出现) + P(不出现)\cdot(报告|不出现) = 0.7\times0.9 + 0.3*0.3 = 0.720  $$

（3）（5分）已知小明报告发现了刺激，求击中（屏幕上确实出现了刺激）的概率（使用条件概率和Bayes公式计算）。
解析：$$P(出现|报告) = \frac{P(出现)\cdot P(报告|出现)}{P(出现)\cdot P(报告|出现)+P(不出现)\cdot P(报告|不出现)}= \frac{0.7\times0.9}{0.7\times 0.9 + (1-0.7)\times 0.3} = \frac{0.63}{0.63 + 0.09} = 0.875 $$

（4）（5分）已知小明没有报告发现刺激，求漏报（屏幕上实际上出现了刺激）的概率（使用条件概率和Bayes公式计算）。
解析：$$P(出现|不报告) = \frac{P(出现)\cdot P(不报告|出现)}{P(出现)\cdot P(不报告|出现)+ P(不出现)\cdot P(不报告|不出现)}= \frac{0.7\times0.1}{0.7\times 0.1 + (1-0.7)\times 0.7} = 0.250 $$
（5）（10分）已知刺激出现的概率为70%，且每次刺激是否出现可视为独立事件，用变量X表示连续3个试次内刺激出现的次数，请绘制X的分布列（4分），并计算X的期望（3分）和方差（3分）（提示：绘制分布列可参考下表。可通过直接计算或使用r计算得出答案，可使用r代码中的dbinom 和data.frame函数）。

```{r}
n = 3
p = 0.7
X = 0:n
Pr = dbinom(X, n, p)
a<-data.frame(X, Pr)
(a)
(EX = sum(X * Pr)) #EX=n*p
(VarX = sum((X-EX)^2 * Pr ))#VarX=n*p*(1-p)
Pr
```

解析：
X	0	1	2	3
P	0.027	0.189	0.441	0.343

#data.frame 函数用于创建数据框，这是 R 中一种用于存储表格数据的主要结构。数据框可以包含不同类型的数据列（数值、字符、因子等）。
```{r}
# 创建一个简单的数据框
name <- c("Alice", "Bob", "Charlie")
age <- c(25, 30, 35)
gender <- c("Female", "Male", "Male")

df <- data.frame(Name = name, Age = age, Gender = gender)
print(df)
```

11、
系数是要求能决定其分布形状的，比如二项分布是靠n和p决定的
```{r}
library(readxl)
data11 = read_xlsx('hw2_data.xlsx')
barplot(data11$y, names.arg = 0:10,main = "CDF", 
        space = 0)

cdf_values <- data11$y
# 计算PMF（差分）
pmf_values <- cdf_values[1] # 计算PMF(0)时取CDF(0)本身
pmf_values <- c(pmf_values, diff(cdf_values))
pmf_values
barplot(pmf_values, names.arg = 0:10,main = "PMF", 
        space = 0)
#如果不会用diff函数也应该会在excel中自行操作

# 计算期望 E[X]
# 不要round之后再算期望，会出现偏差
x_values <- 0:10
expectation <- sum(x_values * pmf_values)
variance <- sum((x_values-expectation)^2 * pmf_values)
print(expectation)
print(variance)

expectation2 <- sum(x_values * round(pmf_values,4))
print(expectation2)
# 期望为6，说明p为0.6
# 不能根据PMF的峰值在x=6得出p = 0.6，因为p=0.61也满足峰值在x=6，因此需要严格计算期望。
# 期望和方差计算一个即可推出p
```

需要提供代码和结果的截图，直接粘贴在word里！也无需每道题单独提交一个rmd
交rmd的作用只是结果做的时候查看过程分，我们不会主动去rmd里找答案

关于排版，一个比较美观的例子