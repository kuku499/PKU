rm(list=ls())
library('readxl')
data = read_xlsx('hw8_data.xlsx')
attach(data)
data$method <- factor(data$method)
data$size <- factor(data$size)
#正态性检验
library(rstatix)
data %>%
group_by(method,size) %>%
shapiro_test(score)
#方差同质性检验&方差分析
library(bruceR)
results <- MANOVA(data, dv = "score", between = c("method", "size"))
summary(results)
library(car)
leveneTest(score ~ method * size, data, center = mean)
# 双因素中间用*连接（因为存在交互作用）
# 但其实更建议直接用MANOVA检验，只需要自己会做shapiro_test就可以
library(bruceR)
# 以后大家就都用MANOVA就行，不要再出现aov等函数了，也方便我们批改
results <- MANOVA(data, dv = "score", between = c("method", "size"))
# emmip(results,"method"~"size")
# 推荐可以先自己看一下数据的样子
#主效应事后检验
EMMEANS(results, effect = "size", p.adjust = "tukey")
#简单主效应&事后比较
EMMEANS(results, effect = "method",by = 'size')
EMMEANS(results, effect = "size",by = 'method')
emmip(results, method ~ size, CIs = T)
# 加上了置信区间
#简单主效应&事后比较
EMMEANS(results, effect = "method",by = 'size')
EMMEANS(results, effect = "method",by = 'size', p.adjust = "scheffe")
EMMEANS(results, effect = "size",by = 'method')
