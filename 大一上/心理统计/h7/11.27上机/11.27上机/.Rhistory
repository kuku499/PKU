# 先创建一个新的列，所有的均记作0
# 再把2-6的和6以上的改成4和8
# 开闭区间一定要看清楚
rm(list = ls())
library(readxl)
data = read_xlsx('hw7_data.xlsx',sheet = 3)
rm(list = ls())
library(readxl)
data = read_xlsx('hw7_data.xlsx')
# attach(data) 无需再写data$
# 列名少且不复杂的时候没必要用
data$condition = as.factor(data$condition)
# 别忘了变为factor，不然可能会报错
library(rstatix)
data %>%
group_by(condition) %>%
shapiro_test(rt)
# 中括号表示条件的限制
shapiro_test(data$rt[data$condition == 0])
shapiro_test(data$rt[data$condition == 4])
shapiro_test(data$rt[data$condition == 8])
library(car)
leveneTest(data$rt,data$condition)
leveneTest(rt ~ condition, data)
# 长数据转为宽数据
matrixdata <- matrix(data$rt, nrow=20, ncol=3)
mlmfit <- lm(matrixdata ~ 1)
mauchly.test(mlmfit,X = ~1)
library(bruceR)
ANOVA_repeated <- MANOVA(data, subID = 'id', dv = 'rt' ,within = 'condition')
# 无需print
# 不需要做方差齐性，也不建议做
# 需要报告的：统计量、p值、效应量（就算不说也要知道报告）
# 效应量都是报partial eta^2(本次不扣分)
# 直接看p就行，无需再把F与临界值比较
?MANOVA
# 单因素独立测量 MANOVA(data=, dv=, between=, ...)
shortdata = read_xlsx('testdata.xlsx')
?MANOVA
# 单因素重复测量 MANOVA(data=, dvs=, dvs.pattern=, within=, ...)
MANOVA(data=shortdata, dvs = 'y:y2',dvs.pattern = '(.*)', within='time')
# within是自己命名的，但是不能和现有的变量名重合
# dvs的写法
# 'y:y2' c('y','y2')
# dvs.pattern 类似于正则表达式
# . 一个字符
# * 重复前面的字符0-n次
# 只需记住这个'(.*)'，可以匹配任意长度的任何字符
# 不能单独写'(*)'，需要写'(.*)'
# 如果你的列名是y_before和y_after，想让两个水平的名称是before和after：'y_(.*)'
?MANOVA
# 双因素独立测量 MANOVA(data=, dv=, between=, ...)
?MANOVA
# 单因素重复测量 MANOVA(data=, subID=, dv=, within=, ...)
longdata = read_xlsx('testdata.xlsx',sheet = 2)
# 试试把shortdata的y和y2转化为long_data
long = data.frame(id = rep(1:20,2), y = c(shortdata$y,shortdata$y2), condition = c(rep(1,20),rep(2,20)))
summary(ANOVA_repeated)
# summary可以得到准确的SS
EMMEANS(ANOVA_repeated, effect = "condition",p.adjust="tukey")  # default is bonferroni correction
EMMEANS(ANOVA_repeated, effect = "condition",p.adjust="scheffe")
emmip(ANOVA_repeated,~ "condition")
# 推荐可以先自己看一下数据的样子
# 只用报告三个显著差异就行，没有必要比较……和……的差异相对较小
# 关于t和效应量的正负
# tukey不是直接和HSD比大小吗，为什么还会有t和p值？
# 昨天讲到的bonferroni
EMMEANS(ANOVA_repeated, effect = "condition")
(q_critical <- qtukey(0.95, 3, 38)) # 代码1分
# 或者查表 书上352页，df在30-40，k=3，q在3.44-3.49之间。应该取3.44（更加严格）
(HSD <- q_critical * sqrt(3636.798/20)) # 代码1分，结果1分
# 这里是MSE，不是MS within
# 别忘了好好整理到cheating sheet上
# 代码3分，结果3分
mean0 = mean(data$rt[data$condition == 0])
mean4 = mean(data$rt[data$condition == 4])
mean8 = mean(data$rt[data$condition == 8])
mean0
mean4
mean8
abs(mean8 - mean4)
abs(mean8 - mean0)
abs(mean4 - mean0)
ANOVA_independent <- MANOVA(data, dv = 'rt' ,between = 'condition')
summary(ANOVA_independent)
# 还是找不到SS，可以去右边的Data栏
library(readxl)
data = read_xlsx('hw7_data.xlsx',sheet = 2)
data$condition = as.factor(data$condition)
library(bruceR)
ANOVA_repeated <- MANOVA(data, subID = 'id', dv = 'rt' ,within = 'condition')
EMMEANS(ANOVA_repeated, effect = "condition",p.adjust="tukey")
qt(0.95,38)
qf(0.90,1,38)
qt(0.95,38)^2
library(rstatix)
data %>%
group_by(condition) %>%
shapiro_test(rt)
rm(list = ls())
library(readxl)
data = read_xlsx('hw7_data.xlsx')
# attach(data) 无需再写data$
# 列名少且不复杂的时候没必要用
data$condition = as.factor(data$condition)
# 别忘了变为factor，不然可能会报错
library(rstatix)
data %>%
group_by(condition) %>%
shapiro_test(rt)
# 中括号表示条件的限制
shapiro_test(data$rt[data$condition == 0])
shapiro_test(data$rt[data$condition == 4])
shapiro_test(data$rt[data$condition == 8])
# 长数据转为宽数据
matrixdata <- matrix(data$rt, nrow=20, ncol=3)
mlmfit <- lm(matrixdata ~ 1)
mauchly.test(mlmfit,X = ~1)
View(matrixdata)
View(data)
View(matrixdata)
View(data)
View(data)
View(data)
View(matrixdata)
View(data)
View(matrixdata)
View(data)
View(matrixdata)
View(data)
View(data)
View(matrixdata)
